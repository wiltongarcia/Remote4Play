<!DOCTYPE HTML>
<html lang="en-US">
	<head>
	    <meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
		<title>Remote4Play</title>
		<link rel="stylesheet" href="css/main.css" type="text/css">
		
        <script src="phonegap.js"></script>
        <script src="childbrowser.js"></script>
        <script src="barcodescanner.js"></script>
	</head>
	<body>
	    <img class="logo" src="img/logo.png" alt="Remote4Play">
		<ul id="options">
		    <li><a id="scan-btn" href="#">connect with qrcode</a></li>
            <li><a id="google-btn" href="google.html">connect using a google account</a></li>
            <li><a id="browser-btn" href="https://ws-music.appspot.com/remote">Open in browser</a></li>
            <li><a id="terms-btn" href="http://ws-music-teste.appspot.com/terms">Terms of Service</a></li>
            <li><a id="privacy-btn" href="http://ws-music-teste.appspot.com/privacy">Privacy Policy</a></li>
		</ul>
        <script type="text/javascript">
		    var _url_param =  function (name, url) {
                return unescape((RegExp(name + '=' +
                    '(.+?)(&|$)').exec(url) || [,null])[1]);
            }
		    
            document.addEventListener('deviceready', function () {

                // qrcode scan button    
                var scan = document.getElementById('scan-btn');
                if (scan) {
                    scan.onclick = function (e) {
                        window.plugins.barcodeScanner.scan(
                            function ( result ) {
                                localStorage.setItem("token",_url_param("token", result.text));
                                localStorage.setItem("user_key",_url_param("user_key", result.text));
                                setTimeout(function(){
                                    location.href = "player.html";
                                },100);
                            },
                            function( err ){
                                console.log(err);
                            }
                        );
                    };
               }

               // browser button
               var browser = document.getElementById('browser-btn');
               if (browser) {
                    browser.onclick = function (e) {
                        e.preventDefault();
                        window.plugins.childBrowser.openExternal(this.href); 
                    }
               }

               // term and privacy buttons
               var buttonList = ['terms', 'privacy'];
               for (var i = 0, l = buttonList.length; i < l; i = i + 1) {
                    var button = document.getElementById(buttonList[i] + '-btn');
                    if (button) {
                        button.onclick = function (e) {
                            e.preventDefault();
                            window.plugins.childBrowser.showWebPage(this.href,{ showLocationBar: false });
                        };
                    }
               }

			}, true);
        </script>
	</body>
</html>
